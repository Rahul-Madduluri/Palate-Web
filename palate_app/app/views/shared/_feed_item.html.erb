<div class="pin">

	<% if (feed_item.is_a? Micropost) %>

		<div class = "feed_gravatar">
			<%= link_to gravatar_for(feed_item.user), feed_item.user %>
		</div>

		<div id = "username">
			<%= link_to feed_item.user.name, feed_item.user %>
		</div>

		<br>
	<% else %>

		<span id="media_title"><%= url_link(feed_item.media.title) %></span>
		
		<div class = "ratings">
			<div class = "official_rating">
				<% unless (feed_item.media.nil? || feed_item.media.official_rating.blank?) %>
					<% for i in (1..(feed_item.media.official_rating*5).ciel) %>
						<div class = "rating_dot">
							<%= image_tag("greycircle.png") %>
						</div>
					<% end %>
				<% end %>
				<% for i in (0..4) %>
					<span class = "rating_dot">
						<%= image_tag("greycircle.png") %>
					</span>
				<% end %>
			</div>
			<br>

			<%= render partial: 'shared/dot_rating', locals: { media: feed_item.media } %>

		</div>
		<br>
		<% unless (feed_item.media.nil? || feed_item.media.spotify_uri.blank?) %>
			<div class = "spotify_play">
				<iframe src="https://embed.spotify.com/?uri=<%= feed_item.media.spotify_uri %>" width="250" height="80" frameborder="0" allowtransparency="true"></iframe>
			</div>
		<% end %>

	<% end %>

	

	<div class ="hr">
		<hr>
	</div>

	<div id="feed_content">
		<% if feed_item.is_a? Micropost %>
			<%= url_link(feed_item.content) %>
		<% else %>
			<%= url_link(Song.find_by(echonest_id: feed_item.media.echonest_id).artist.image_url) %>
		<% end %>
	</div>

	<div id="timeago">
		Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
	</div>
    
    <% if (feed_item.is_a? Micropost) %>
		<% if current_user?(feed_item.user) %>
			<%= link_to "delete", feed_item, method: :delete,
		                                 data: { confirm: "You sure?" },
		                                 title: feed_item.content %>
		<% end %>
	<% end %>

</div>

<script>
	// Variable to set the duration of the animation
	
	// Handle the hover events
	$(".red_dot").hover(function() {
		$(this).siblings().stop().fadeOut();
	},
	function() {
		$(this).siblings().fadeIn();
	});

	$(".yellow_dot").hover(function() {
		$(this).siblings(".green_dot").stop().fadeOut();
		$(this).siblings(".blue_dot").stop().fadeOut();
		$(this).siblings(".purple_dot").stop().fadeOut();
	},
	function() {
		$(this).siblings(".green_dot").fadeIn();
		$(this).siblings(".blue_dot").fadeIn();
		$(this).siblings(".purple_dot").fadeIn();
	});

	$(".green_dot").hover(function() {
		$(this).siblings(".blue_dot").stop().fadeOut();
		$(this).siblings(".purple_dot").stop().fadeOut();
	},
	function() {
		$(this).siblings(".blue_dot").fadeIn();
		$(this).siblings(".purple_dot").fadeIn();
	});

	$(".blue_dot").hover(function() {
		$(this).siblings(".purple_dot").stop().fadeOut();
	},
	function() {
		$(this).siblings(".purple_dot").fadeIn();
	});
	/*
	// Prevent the click event and show the rating
	$(".red_dot").click(function() {
		$(this).unbind('mouseenter mouseleave');
		$(this).siblings().unbind('mouseenter mouseleave');
		$(this).unbind('click');
		$(this).siblings().unbind('click');
	});

	$(".yellow_dot").click(function() {
		$(this).unbind('mouseenter mouseleave');
		$(this).siblings().unbind('mouseenter mouseleave');
		$(this).unbind('click');
		$(this).siblings().unbind('click');
	});

	$(".green_dot").click(function() {
		$(this).unbind('mouseenter mouseleave');
		$(this).siblings().unbind('mouseenter mouseleave');
		$(this).unbind('click');
		$(this).siblings().unbind('click');
	});

	$(".blue_dot").click(function() {
		$(this).unbind('mouseenter mouseleave');
		$(this).siblings().unbind('mouseenter mouseleave');
		$(this).unbind('click');
		$(this).siblings().unbind('click');
	});
	*/


	

      
</script>


